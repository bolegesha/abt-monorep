(()=>{var e={};e.id=235,e.ids=[235],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},6005:e=>{"use strict";e.exports=require("node:crypto")},579:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>d,routeModule:()=>m,tree:()=>u}),r(3415),r(843),r(2340);var s=r(3324),n=r(8099),o=r(5610),a=r.n(o),l=r(9970),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);r.d(t,i);let u=["",{children:["auth",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,3415)),"/Users/aldiyarbolegenov/my-monorepo/apps/dashboard/src/app/auth/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,843)),"/Users/aldiyarbolegenov/my-monorepo/apps/dashboard/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,2340,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/aldiyarbolegenov/my-monorepo/apps/dashboard/src/app/auth/page.tsx"],c="/auth/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/auth/page",pathname:"/auth",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},1763:(e,t,r)=>{Promise.resolve().then(r.bind(r,2036))},3340:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5438,23)),Promise.resolve().then(r.t.bind(r,9457,23)),Promise.resolve().then(r.t.bind(r,1240,23)),Promise.resolve().then(r.t.bind(r,1241,23)),Promise.resolve().then(r.t.bind(r,3786,23)),Promise.resolve().then(r.t.bind(r,3858,23))},9598:(e,t,r)=>{Promise.resolve().then(r.bind(r,7342))},2036:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(2913),n=r(7761),o=r(1018),a=r(5809),l=r(6025),i=r(7552),u=r(2312),d=r(8197),c=r.n(d),p=r(7342);let m=c()(async()=>{},{loadableGenerated:{modules:["app/auth/page.tsx -> @/components/interactive-map"]},ssr:!1});function f(){(0,u.useRouter)();let{login:e,signup:t,error:r,loading:d,user:c}=(0,o.v$)(),[f,h]=(0,n.useState)(!0),[x,g]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),v=async r=>{r.preventDefault(),b(null),g(!0);try{let s=new FormData(r.currentTarget),n=s.get("email"),o=s.get("password");if(f)await e(n,o),p.A.success("Successfully signed in!");else{let e=s.get("name"),r=s.get("user_type");await t(n,o,e,r),p.A.success("Account created successfully!")}}catch(t){console.error("Auth error:",t);let e=t instanceof Error?t.message:"Authentication failed";b(e),p.A.error(e)}finally{g(!1)}};return s.jsx(s.Fragment,{children:x?s.jsx("div",{children:"Processing..."}):(0,s.jsxs)("div",{className:"flex flex-col md:flex-row h-screen bg-[#F5F5F7]",children:[s.jsx("div",{className:"md:w-3/5 h-1/3 md:h-full",children:s.jsx(m,{})}),s.jsx("div",{className:"md:w-2/5 p-8 flex flex-col justify-center h-2/3 md:h-full overflow-y-auto",children:(0,s.jsxs)("div",{className:"max-w-lg w-full mx-auto space-y-10",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-4xl font-semibold text-[#1D1D1F] text-center mb-2",children:f?"Welcome Back":"Create Account"}),s.jsx("p",{className:"text-center text-[#86868B] text-lg",children:f?"Sign in to your account":"Sign up for a new account"})]}),y&&s.jsx("div",{className:"bg-[#FFF0F0] text-[#FF3B30] p-4 rounded-xl text-center",role:"alert",children:s.jsx("span",{className:"font-medium",children:y})}),(0,s.jsxs)("form",{onSubmit:v,className:"space-y-8",children:[!f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[s.jsx(i._,{htmlFor:"name",className:"text-[#1D1D1F] text-sm font-medium",children:"Full Name"}),s.jsx(l.I,{id:"name",name:"name",type:"text",autoComplete:"name",required:!0,disabled:x,className:"mt-1 w-full px-4 py-4 bg-white border border-[#D1D1D6] rounded-xl focus:ring-2 focus:ring-[#0071E3] focus:border-transparent transition-colors text-lg",placeholder:"Enter your full name"})]}),(0,s.jsxs)("div",{children:[s.jsx(i._,{htmlFor:"user_type",className:"text-[#1D1D1F] text-sm font-medium",children:"Account Type"}),(0,s.jsxs)("select",{id:"user_type",name:"user_type",required:!0,disabled:x,className:"mt-1 w-full px-4 py-4 bg-white border border-[#D1D1D6] rounded-xl focus:ring-2 focus:ring-[#0071E3] focus:border-transparent transition-colors text-lg",children:[s.jsx("option",{value:"user",children:"User"}),s.jsx("option",{value:"worker",children:"Worker"})]})]})]}),(0,s.jsxs)("div",{children:[s.jsx(i._,{htmlFor:"email-address",className:"text-[#1D1D1F] text-sm font-medium",children:"Email Address"}),s.jsx(l.I,{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,disabled:x,className:"mt-1 w-full px-4 py-4 bg-white border border-[#D1D1D6] rounded-xl focus:ring-2 focus:ring-[#0071E3] focus:border-transparent transition-colors text-lg",placeholder:"Enter your email address"})]}),(0,s.jsxs)("div",{children:[s.jsx(i._,{htmlFor:"password",className:"text-[#1D1D1F] text-sm font-medium",children:"Password"}),s.jsx(l.I,{id:"password",name:"password",type:"password",autoComplete:f?"current-password":"new-password",required:!0,disabled:x,className:"mt-1 w-full px-4 py-4 bg-white border border-[#D1D1D6] rounded-xl focus:ring-2 focus:ring-[#0071E3] focus:border-transparent transition-colors text-lg",placeholder:"Enter your password"})]}),s.jsx(a.z,{type:"submit",disabled:x,className:"w-full bg-[#00358E] text-white py-4 px-6 rounded-xl text-lg font-medium hover:bg-[#0077ED] transition-colors focus:outline-none focus:ring-2 focus:ring-[#0071E3] focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Processing...":f?"Sign In":"Sign Up"})]}),s.jsx("div",{className:"text-center",children:s.jsx(a.z,{onClick:()=>{h(!f),b(null)},variant:"link",disabled:x,className:"text-[#00358E] hover:text-[#0077ED] text-lg",children:f?"Create a new account":"Already have an account? Sign in"})})]})})]})})}},5809:(e,t,r)=>{"use strict";r.d(t,{z:()=>u});var s=r(2913),n=r(7761),o=r(9812),a=r(7326),l=r(4255);let i=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},u)=>{let d=n?o.g7:"button";return s.jsx(d,{className:(0,l.cn)(i({variant:t,size:r,className:e})),ref:u,...a})});u.displayName="Button"},6025:(e,t,r)=>{"use strict";r.d(t,{I:()=>a});var s=r(2913),n=r(7761),o=r(4255);let a=n.forwardRef(({className:e,type:t,...r},n)=>s.jsx("input",{type:t,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));a.displayName="Input"},7552:(e,t,r)=>{"use strict";r.d(t,{_:()=>u});var s=r(2913),n=r(7761),o=r(9514),a=r(7326),l=r(4255);let i=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=n.forwardRef(({className:e,...t},r)=>s.jsx(o.f,{ref:r,className:(0,l.cn)(i(),e),...t}));u.displayName=o.f.displayName},4255:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(9715),n=r(7948);function o(...e){return(0,n.m6)((0,s.W)(e))}},8197:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let s=r(2840);r(2913),r(7761);let n=s._(r(8266));function o(e,t){var r;let s={loading:e=>{let{error:t,isLoading:r,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let o={...s,...t};return(0,n.default)({...o,modules:null==(r=o.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}});let s=r(8885);function n(e){let{reason:t,children:r}=e;throw new s.BailoutToCSRError(t)}},8266:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return u}});let s=r(2913),n=r(7761),o=r(5912),a=r(9095);function l(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},u=function(e){let t={...i,...e},r=(0,n.lazy)(()=>t.loader().then(l)),u=t.loading;function d(e){let l=u?(0,s.jsx)(u,{isLoading:!0,pastDelay:!0,error:null}):null,i=t.ssr?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.PreloadCss,{moduleIds:t.modules}),(0,s.jsx)(r,{...e})]}):(0,s.jsx)(o.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(r,{...e})});return(0,s.jsx)(n.Suspense,{fallback:l,children:i})}return d.displayName="LoadableComponent",d}},9095:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return o}});let s=r(2913),n=r(5403);function o(e){let{moduleIds:t}=e,r=(0,n.getExpectedRequestStore)("next/dynamic css"),o=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));o.push(...t)}}return 0===o.length?null:(0,s.jsx)(s.Fragment,{children:o.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},1018:(e,t,r)=>{"use strict";r.d(t,{db:()=>i,VW:()=>u,v$:()=>v});var s=r(6398),n=r(7761),o=r(5006),a=r(6910);o.vK.fetchConnectionCache=!0;let l=(0,o.qn)("postgresql://test_owner:RGVN7JQZFfW8@ep-delicate-cherry-a27u5pat-pooler.eu-central-1.aws.neon.tech/test?sslmode=require"),i=(0,a.tS)(l,{schema:s});function u(e,t){let[r,s]=(0,n.useState)({cities:[],rates:null}),[o,a]=(0,n.useState)(null);return[r,o]}var d=r(2312),c=r(946),p=r(3838),m=r(5497);class f extends Error{constructor(e){super(e),this.name="AuthError"}}async function h(e){if((await i.select().from(s.users).where((0,p.eq)(s.users.email,e.email)).limit(1))[0])throw new f("User already exists");let t=await (0,m.hash)(e.password,10),[r]=await i.insert(s.users).values({id:(0,c.x0)(),...e,password:t}).returning();if(!r)throw new f("Failed to create user");let n=await x(r.id);if(!n)throw new f("Failed to create session");return{user:r,session:n.token}}async function x(e){await i.delete(s.sessions).where((0,p.eq)(s.sessions.userId,e));let[t]=await i.insert(s.sessions).values({id:(0,c.x0)(),userId:e,token:(0,c.x0)(32),expiresAt:new Date(Date.now()+108e5)}).returning();return t}async function g(e){try{let[t]=await i.select().from(s.sessions).where((0,p.eq)(s.sessions.token,e)).limit(1);if(!t)return null;if(new Date>t.expiresAt)return await i.delete(s.sessions).where((0,p.eq)(s.sessions.token,e)),null;let[r]=await i.select().from(s.users).where((0,p.eq)(s.users.id,t.userId)).limit(1);return r||null}catch(e){return console.error("Error getting user by session:",e),null}}let y=(e,t)=>{let r=new Date(Date.now()+108e5).toUTCString();document.cookie=`${e}=${t}; expires=${r}; path=/`},b=e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`};function v(){let[e,t]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[o,a]=(0,n.useState)(null),[l,i]=(0,n.useState)(!0),u=(0,d.useRouter)();return(0,d.usePathname)(),{user:e,token:r,error:o,loading:l,login:async(e,r)=>{i(!0),a(null);try{let n=await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),o=await n.json();if(!n.ok||!o.success)throw Error(o.error||"Authentication failed");y("authToken",o.token),localStorage.setItem("authToken",o.token),t(o.user),s(o.token),"admin"===o.user.user_type?u.push("/admin"):"worker"===o.user.user_type?u.push("/worker-profile"):u.push("/profile")}catch(e){throw console.error("Login error:",e),a(e instanceof Error?e.message:"Login failed"),e}finally{i(!1)}},signup:async(e,r,n,o)=>{i(!0),a(null);try{let{user:a,session:l}=await h({email:e,password:r,fullName:n,user_type:o});y("authToken",l),localStorage.setItem("authToken",l),t(a),s(l),"worker"===o?u.push("/worker-profile"):u.push("/profile")}catch(e){throw console.error("Signup error:",e),a("An error occurred during signup"),e}finally{i(!1)}},logout:async()=>{i(!0);try{if(!(await fetch("/api/logout",{method:"POST"})).ok)throw Error("Logout failed");localStorage.removeItem("authToken"),b("authToken"),t(null),s(null),window.location.href="http://localhost:3000"}catch(e){console.error("Logout error:",e),a("An error occurred during logout")}finally{i(!1)}},checkSession:(0,n.useCallback)(async()=>{try{let e=localStorage.getItem("authToken");if(!e)return t(null),s(null),i(!1),!1;let r=await g(e);if(r)return t(r),s(e),i(!1),!0;return localStorage.removeItem("authToken"),t(null),s(null),i(!1),!1}catch(e){return console.error("Error checking session:",e),t(null),s(null),i(!1),!1}},[])}}},6398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{baseCosts:()=>c,sessions:()=>u,shippingRoutes:()=>d,users:()=>i});var s=r(2753),n=r(6198),o=r(2386),a=r(8649),l=r(1860);let i=(0,s.af)("users",{id:(0,n.L7)("id").primaryKey(),email:(0,n.L7)("email").notNull().unique(),password:(0,n.L7)("password").notNull(),fullName:(0,n.L7)("full_name").notNull(),user_type:(0,n.L7)("user_type",{enum:["user","worker","admin"]}).notNull()}),u=(0,s.af)("sessions",{id:(0,n.L7)("id").primaryKey(),userId:(0,n.L7)("user_id").notNull().references(()=>i.id),token:(0,n.L7)("token").notNull().unique(),expiresAt:(0,o.AB)("expires_at").notNull()}),d=(0,s.af)("shipping_routes",{startCity:(0,n.L7)("start_city").notNull(),endCity:(0,n.L7)("end_city").notNull(),pricePerKgComposition:(0,a.gH)("price_per_kg_composition").notNull(),pricePerKgDoor:(0,a.gH)("price_per_kg_door").notNull(),estimatedDeliveryDaysMin:(0,l._L)("estimated_delivery_days_min").notNull(),estimatedDeliveryDaysMax:(0,l._L)("estimated_delivery_days_max").notNull()}),c=(0,s.af)("base_costs",{baseCostComposition:(0,a.gH)("base_cost_composition").notNull(),baseCostDoor:(0,a.gH)("base_cost_door").notNull()})},3415:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>o,default:()=>l});var s=r(2293);let n=(0,s.createProxy)(String.raw`/Users/aldiyarbolegenov/my-monorepo/apps/dashboard/src/app/auth/page.tsx`),{__esModule:o,$$typeof:a}=n;n.default;let l=(0,s.createProxy)(String.raw`/Users/aldiyarbolegenov/my-monorepo/apps/dashboard/src/app/auth/page.tsx#default`)},843:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,metadata:()=>l});var s=r(8564),n=r(8980),o=r.n(n),a=r(3145);r(7178),r(153);let l={title:"Dashboard",description:"User profile and authentication"};function i({children:e}){return s.jsx("html",{lang:"en",children:(0,s.jsxs)("body",{className:o().className,children:[s.jsx(a.x7,{position:"top-center"}),e]})})}},7178:()=>{},9514:(e,t,r)=>{"use strict";r.d(t,{f:()=>l});var s=r(7761),n=r(9995),o=r(2913),a=s.forwardRef((e,t)=>(0,o.jsx)(n.WV.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));a.displayName="Label";var l=a},9995:(e,t,r)=>{"use strict";r.d(t,{WV:()=>l,jH:()=>i});var s=r(7761),n=r(3700),o=r(9812),a=r(2913),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=s.forwardRef((e,r)=>{let{asChild:s,...n}=e,l=s?o.g7:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(l,{...n,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function i(e,t){e&&n.flushSync(()=>e.dispatchEvent(t))}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[796,874,724,604],()=>r(579));module.exports=s})();